<!doctype html>
<html lang="zh-CN">
<head>
<script>window.RelRoot = "../";</script>
<meta charset="utf-8">
<title>æˆ‘çš„è¡Œç¨‹ - Nebulaå‡ºè¡Œ</title>
<link rel="stylesheet" href="../static/skin.css">
<link rel="stylesheet" href="../static/components.css">
</head>
<body>
<div class="navbar">
  <div class="inner">
    <div class="brand"><div class="logo"></div> Nebulaå‡ºè¡Œ</div>
    <div class="navlinks">
      <a href="../trip.local/dashboard.html">é¦–é¡µ</a>
      <a href="../trip.local/flights.html">èˆªç­</a>
      <a href="../trip.local/hotels.html">é…’åº—</a>
      <a href="../trip.local/manage.html" class="active">æˆ‘çš„è¡Œç¨‹</a>
    </div>
    <div style="margin-left:auto">
      <button id="user-menu-btn" style="background:none; border:none; color:var(--text); font-size:20px; cursor:pointer">
        ğŸ‘¤
      </button>
    </div>
  </div>
</div>

<div class="container">
  <h1 style="font-size:28px; font-weight:700; margin:24px 0">æˆ‘çš„è¡Œç¨‹</h1>
  
  <div id="trips-list">
    <div class="card p-8 text-center muted">åŠ è½½ä¸­...</div>
  </div>
</div>

<script src="../static/common.js"></script>
<script src="../static/components.js"></script>
<script>
async function loadTrips() {
  const container = document.getElementById('trips-list');
  try {
    const env = await loadEnv();
    const flight = env.trips?.flight;
    const hotel = env.trips?.hotel;
    
    let content = '';

    if (flight && flight.pnr) {
      content += `
        <div class="card p-6 mb-4">
          <div class="flex justify-between items-center mb-4">
            <div>
              <div class="text-xl font-bold">èˆªç­é¢„è®¢</div>
              <div class="text-sm muted">PNR: ${flight.pnr}</div>
            </div>
            <div class="badge ok">å·²ç¡®è®¤</div>
          </div>
          <div class="flex gap-8">
            <div>
              <div class="text-sm muted">ç›®çš„åœ°</div>
              <div class="font-bold">${flight.destination}</div>
            </div>
            <div>
              <div class="text-sm muted">æ—¥æœŸ</div>
              <div class="font-bold">${flight.date}</div>
            </div>
            <div>
              <div class="text-sm muted">ä»·æ ¼</div>
              <div class="font-bold">Â¥${flight.price}</div>
            </div>
          </div>
        </div>
      `;
    }

    if (hotel && hotel.id) {
      content += `
        <div class="card p-6 mb-4">
          <div class="flex justify-between items-center mb-4">
            <div>
              <div class="text-xl font-bold">é…’åº—é¢„è®¢</div>
              <div class="text-sm muted">ID: ${hotel.id}</div>
            </div>
            <div class="badge ok">å·²ç¡®è®¤</div>
          </div>
          <div class="flex gap-8">
            <div>
              <div class="text-sm muted">åŸå¸‚</div>
              <div class="font-bold">${hotel.city}</div>
            </div>
            <div>
              <div class="text-sm muted">å…¥ä½æ—¥æœŸ</div>
              <div class="font-bold">${hotel.checkin}</div>
            </div>
            <div>
              <div class="text-sm muted">æ™šæ•°</div>
              <div class="font-bold">${hotel.nights}</div>
            </div>
          </div>
        </div>
      `;
    }

    if (content) {
      container.innerHTML = content;
    } else {
      container.innerHTML = '<div class="card p-8 text-center muted">æš‚æ— é¢„è®¢è¡Œç¨‹</div>';
    }

  } catch (e) {
    console.error('Failed to load trips:', e);
    container.innerHTML = '<div class="card p-8 text-center err">åŠ è½½å¤±è´¥</div>';
  }
}

document.addEventListener('DOMContentLoaded', loadTrips);
</script>
</body>
</html>
